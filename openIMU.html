<!DOCTYPE html>
<html>
    <div class="openimu">
        <head>
            <link rel="stylesheet" href="index.css">
            <link rel="stylesheet" href="assets/prism/prism.css" />
            <script src="assets/prism/prism.js"></script>

        </head>
        
        <div class="nav">
            <a href="index.html">Home</a>
            <a href="hardware.html">Hardware</a>
            <a href="software.html">Software</a>
            <a id="currentpage" href="#">OpenIMU</a>
            <a href="https://crowforce10809.wixsite.com/ftc-robotics" target="_blank">Business Website</a>
        </div>

        <div class="header">
            <h1>
                OpenIMU
            </h1>
        </div>

        <div class="block">
            <h1>Background</h1>
            <h2>The Problem</h2>
            <p>Over our first three competitions, we sacrificed points as a result of IMU resets. We learned that these resets were a result of static discharge (also known as ESD), which reset the percieved orientation of our robot, causing autonomous trajectory sequences to fail, as well as field centric driving. Our research shows us that this problem is new this year due to a faulty chip in the 2023-24 REV robotics control hub.</p>
            <hr>
            <h2>Solution</h2>
            <p>A simple solution would be to use last years control hub, but if you are a new team who doesnt have one, or do not want to spend the money and time to get one, below is a step by step way to set up an external imu using last years control hub IMU chip! </p>
        </div>

        <div class="block">
            <h1>Hardware</h1>
            <h3>Some Assembly Required</h3>
            <p>
                To build the OpenIMU, you will need some base knowledge on/with:
                <ul>
                    <li>Soldering</li>
                    <li>General Hardware Assembly</li>
                    <li>3D Printing and Post-Processing Prints</li>
                </ul>
            </p>
            <hr>
            <h3>Assembly Instructions:</h3>
            <p>WIP, coming soon :)</p>
        </div>

        <div class="block">
            <h1>Software</h1>
            <h3>Driver Station</h3>
            <p>It is very easy to get your external IMU to talk to your driver station, below are instructions on how to add the external IMU to your driver station.</p>
            <hr>

            <img src="assets/images/DriverStation1.png">
            <p>1. Go to the configure robot section under the three dots in the top right.</p>

            <img src="assets/images/DriverStation2.png">
            <p>2. Go into the control hub portal.</p>

            <img src="assets/images/DriverStation3.png">
            <p>3. Click on control hub.</p>

            <img src="assets/images/DriverStation4.png">
            <p>4. Scroll down to I2C Bus 0.</p>

            <img src="assets/images/DriverStation5.png">
            <p>5. Change this port to "nothing". If you try to add your external IMU here, the control hub will try to fight for what it deems the real "imu" which never works.</p>

            <img src="assets/images/DriverStation6.png">
            <p>6. Now go to I2C port 1 and add an "adafruit IMU".</p>

            <img src="assets/images/DriverStation7.png">
            <p>7. The name of the adafruit should be the name of your IMU in code (shown below).</p>
            
            <hr>

            <h3>Code:</h3>
            <p>The code below shows how to setup your new IMU. Make the name of your imu matches the name in IC Bus 2 slot on your drive hub. Another thing to note is the Orientation we have given about our IMU. This changes depending on how you have your external IMU positioned.</p>

            <pre><code class="language-java"><![CDATA[
package org.firstinspires.ftc.teamcode.tests;

import com.qualcomm.hardware.rev.RevHubOrientationOnRobot;
import com.qualcomm.robotcore.eventloop.opmode.LinearOpMode;
import com.qualcomm.robotcore.eventloop.opmode.TeleOp;
import com.qualcomm.robotcore.hardware.IMU;

import org.firstinspires.ftc.robotcore.external.navigation.AngleUnit;
import org.firstinspires.ftc.robotcore.external.navigation.AxesOrder;
import org.firstinspires.ftc.robotcore.external.navigation.AxesReference;


@TeleOp(name = "External IMU Test", group = "Teleop")

public class ExternalIMU extends LinearOpMode {
    public IMU imu;
    public void runOpMode() throws InterruptedException {

        //Set up IMU
        imu = hardwareMap.get(IMU.class, "imu");
        IMU.Parameters myIMUparameters1;

        //Parameters for IMU
        myIMUparameters1 = new IMU.Parameters(
                new RevHubOrientationOnRobot(
                        RevHubOrientationOnRobot.LogoFacingDirection.UP,
                        RevHubOrientationOnRobot.UsbFacingDirection.BACKWARD
                )
        );

        imu.initialize(myIMUparameters1);

        //Resets Values
        imu.resetYaw();

        waitForStart();
        while (opModeIsActive()) {
            telemetry.addData("IMU Value", getAngle());
            telemetry.update();
        }
    }
    public double getAngle() {
        return imu.getRobotOrientation(AxesReference.EXTRINSIC, AxesOrder.ZYX,
            AngleUnit.DEGREES).firstAngle;
    }
}
            ]]></code></pre>
        </div>


        <div class="footer">
            <a href="https://github.com/CrowForce" target="_blank">Github</a> | <a href="https://crowforce10809.wixsite.com/ftc-robotics" target="_blank">Buisness Website</a>
        </div>
    </div>
</html>
